<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Ruby: Clean your code!" /><meta property="og:locale" content="en" /><meta name="description" content="Minimize the number of “nested if statement” “nested if statement” is normally considered as the code smell. We should try to minimize the number of “nested if statement”, though we cannot avoid using it completely." /><meta property="og:description" content="Minimize the number of “nested if statement” “nested if statement” is normally considered as the code smell. We should try to minimize the number of “nested if statement”, though we cannot avoid using it completely." /><link rel="canonical" href="/posts/ruby-clean-your-code/" /><meta property="og:url" content="/posts/ruby-clean-your-code/" /><meta property="og:site_name" content="Jevan Wu" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2014-05-05T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Ruby: Clean your code!" /><meta name="twitter:site" content="@JevanWu" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-03T12:37:32+08:00","datePublished":"2014-05-05T00:00:00+08:00","description":"Minimize the number of “nested if statement” “nested if statement” is normally considered as the code smell. We should try to minimize the number of “nested if statement”, though we cannot avoid using it completely.","headline":"Ruby: Clean your code!","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/ruby-clean-your-code/"},"url":"/posts/ruby-clean-your-code/"}</script><title>Ruby: Clean your code! | Jevan Wu</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Jevan Wu"><meta name="application-name" content="Jevan Wu"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://zhishi.oss-cn-beijing.aliyuncs.com/perm/avatar/1.jpeg?x-oss-process=image/resize,h_150,m_lfit" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Jevan Wu</a></div><div class="site-subtitle font-italic">Don't Panic</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jevanwu" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://linkedin.com/in/jevan-wu" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jevanwu','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Ruby: Clean your code!</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Ruby: Clean your code!</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">jevanwu</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1399219200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2014-05-05 </em> </span> <span> Updated <em class="timeago" data-ts="1643863052" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-03 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="160 words"> <em>1 min</em> read</span></div></div></div><div class="post-content"><h2 id="minimize-the-number-of-nested-if-statement">Minimize the number of “nested if statement” <a href="#minimize-the-number-of-nested-if-statement" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>“nested if statement” is normally considered as the code smell. We should try to minimize the number of “nested if statement”, though we cannot avoid using it completely.</p><h3 id="if-the-if-statement-is-embraced-by-a-loop-and-without-else-use-next-instead">if the ‘if statement’ is embraced by a loop and without ‘else’, use ‘next’ instead <a href="#if-the-if-statement-is-embraced-by-a-loop-and-without-else-use-next-instead" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>original code:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> <span class="n">foo</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
   <span class="k">if</span> <span class="n">bar</span>
     <span class="k">if</span> <span class="n">baz</span>
       <span class="o">...</span>
     <span class="k">else</span>
       <span class="o">...</span>
     <span class="k">end</span>
   <span class="k">end</span>
 <span class="k">end</span>
</pre></table></code></div></div><p>It looks not quike clean, isn’t it?</p><p>cleaned code:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> <span class="n">foo</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
   <span class="k">next</span> <span class="k">if</span> <span class="n">bar</span>
   <span class="k">if</span> <span class="n">baz</span>
     <span class="o">...</span>
   <span class="k">else</span>
     <span class="o">...</span>
   <span class="k">end</span>
 <span class="k">end</span>
</pre></table></code></div></div><p>It looks much better to me.</p><h3 id="use-variable-to-eliminate-the-if-statement">use variable to eliminate the ‘if statement’ <a href="#use-variable-to-eliminate-the-if-statement" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>original code:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> <span class="k">if</span> <span class="n">bar</span>
   <span class="nb">name</span> <span class="o">=</span> <span class="s2">"Jevan"</span>
   <span class="n">age</span> <span class="o">=</span> <span class="mi">24</span>
 <span class="k">else</span>
   <span class="nb">name</span> <span class="o">=</span> <span class="s2">"John"</span>
   <span class="n">age</span> <span class="o">=</span> <span class="mi">24</span>
 <span class="k">end</span>
</pre></table></code></div></div><p>cleaned code:</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> <span class="n">user_name</span> <span class="o">=</span> <span class="n">bar</span> <span class="p">?</span> <span class="s2">"Jevan"</span> <span class="p">:</span> <span class="s2">"John"</span>
 <span class="nb">name</span> <span class="o">=</span> <span class="n">user_name</span>
 <span class="n">age</span> <span class="o">=</span> <span class="mi">24</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/programming/'>programming</a>, <a href='/categories/ruby/'>ruby</a></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E8%81%94%E7%B3%BB%E4%B8%8E%E4%BD%BF%E7%94%A8/">数据结构的联系与使用</a><li><a href="/posts/how-to-know-the-trending-of-economy/">如何判断当前的经济情况</a><li><a href="/posts/the-precious-links/">The Precious Links</a><li><a href="/posts/learning-metaprogramming/">Learning metaprogramming</a><li><a href="/posts/%E8%81%8A%E4%B8%80%E8%81%8A%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">聊一聊设计模式</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/learning-metaprogramming/"><div class="card-body"> <em class="timeago small" data-ts="1422742040" > 2015-02-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Learning metaprogramming</h3><div class="text-muted small"><p> Dynamic Patch the send method could be used to call methods 1 obj.send(:my_method, params) Dynamic Method the define_method method could be used to create instance method 1 2 3 4 5 6 class ...</p></div></div></a></div><div class="card"> <a href="/posts/how-to-set-up-the-environment-of-ruby-on-rails/"><div class="card-body"> <em class="timeago small" data-ts="1394318142" > 2014-03-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to set up the environment of Ruby on Rails</h3><div class="text-muted small"><p> Install RVM and Ruby RVM is used to manage different version of ruby. With RVM, you can switch between multiple different version of ruby. To install RVM, simply type the following command in the...</p></div></div></a></div><div class="card"> <a href="/posts/%E8%81%8A%E4%B8%80%E8%81%8A%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><div class="card-body"> <em class="timeago small" data-ts="1605369600" > 2020-11-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>聊一聊设计模式</h3><div class="text-muted small"><p> 背景 作为程序员，数据结构, 算法和设计模式是经常被提起，且绕不过的三扇大门。对这三项通用技能的掌握可能直接影响你能拿到手的钱。 相对来说，数据结构和算法还是比较实际，只要你花时间，不断练习，都不会太差的东西，类似武功中的招数。而设计模式却虚无缥缈很多，类似于武功的心法，需要你自己领悟，只有真正领悟透彻后，它才是你能够使用的利器。 那学习设计模式，我们又是在学习什么呢？它能给我们带来什么...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-to-set-up-the-environment-of-ruby-on-rails/" class="btn btn-outline-primary" prompt="Older"><p>How to set up the environment of Ruby on Rails</p></a> <a href="/posts/learning-metaprogramming/" class="btn btn-outline-primary" prompt="Newer"><p>Learning metaprogramming</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/username">jevanwu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>
